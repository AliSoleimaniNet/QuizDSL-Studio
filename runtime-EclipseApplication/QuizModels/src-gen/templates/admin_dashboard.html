{% extends 'admin_base.html' %}
{% block admin_content %}
<div class='space-y-8'>
  <header>
    <h1 class='text-3xl font-black' style='color: var(--text)'>خلاصه وضعیت سامانه</h1>
    <p class='opacity-50 text-sm mt-1'>گزارش عملکرد کلی پلتفرم آزمون</p>
  </header>

  
  <div class='grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6'>
    <div class='glass p-6 rounded-[2rem] border-r-4 border-[var(--primary)]'>
      <p class='text-xs opacity-50 mb-1'>کل کاربران</p>
      <div class='flex items-end justify-between'>
        <span class='text-3xl font-black'>{{ stats.users }}</span>
        <i class='fa-solid fa-users text-2xl opacity-20'></i>
      </div>
    </div>
    <div class='glass p-6 rounded-[2rem] border-r-4 border-blue-500'>
      <p class='text-xs opacity-50 mb-1'>آزمون‌های ثبت شده</p>
      <div class='flex items-end justify-between'>
        <span class='text-3xl font-black'>{{ stats.results }}</span>
        <i class='fa-solid fa-graduation-cap text-2xl opacity-20'></i>
      </div>
    </div>
    <div class='glass p-6 rounded-[2rem] border-r-4 border-green-500'>
      <p class='text-xs opacity-50 mb-1'>میانگین نمرات</p>
      <div class='flex items-end justify-between'>
        <span class='text-3xl font-black'>{{ stats.avg }}</span>
        <i class='fa-solid fa-star text-2xl opacity-20'></i>
      </div>
    </div>
    <div class='glass p-6 rounded-[2rem] border-r-4 border-purple-500'>
      <p class='text-xs opacity-50 mb-1'>تعداد مدیران</p>
      <div class='flex items-end justify-between'>
        <span class='text-3xl font-black'>{{ stats.admins }}</span>
        <i class='fa-solid fa-user-tie text-2xl opacity-20'></i>
      </div>
    </div>
  </div>

  
  <div class='glass rounded-[2.5rem] overflow-hidden'>
    <div class='p-6 border-b border-[var(--card-border)] bg-[var(--card-bg)]/30 flex justify-between items-center'>
      <h3 class='font-bold'>آخرین پاسخنامه‌های دریافتی</h3>
      <a href='/admin/results' class='text-xs text-[var(--primary)] hover:underline'>مشاهده همه</a>
    </div>
    <div class='overflow-x-auto'>
      <table class='w-full text-right'>
        <thead>
          <tr class='text-xs opacity-40'>
            <th class='p-5 font-medium'>کاربر</th>
            <th class='p-5 font-medium'>آزمون</th>
            <th class='p-5 font-medium'>نمره</th>
            <th class='p-5 font-medium'>وضعیت</th>
          </tr>
        </thead>
        <tbody class='text-sm'>
          {% for r in recent %}
          <tr class='border-t border-[var(--card-border)] hover:bg-[var(--card-bg)]/20 transition'>
            <td class='p-5 font-bold'>{{ r.user.full_name if r.user else 'مهمان' }}</td>
            <td class='p-5 opacity-70'>{{ r.display_name }}</td>
            <td class='p-5 font-mono'>{{ r.finalScore }}</td>
            <td class='p-5'>
               <span class='w-2 h-2 rounded-full bg-green-500 inline-block ml-2'></span>
               <span class='text-[10px] opacity-50'>ثبت شده</span>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}